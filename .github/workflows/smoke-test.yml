name: CI Smoke Test

# Trigger on Pull Requests to main or direct pushes to main
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  quality-gate:
    name: Build Verification
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ›‘ Checkout Repo
        uses: actions/checkout@v4

      - name: ğŸ“¦ Install pnpm
        uses: pnpm/action-setup@v3
        with:
          version: 9

      - name: ğŸŸ¢ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'pnpm'

      - name: â¬‡ï¸ Install Dependencies
        run: pnpm install --frozen-lockfile

      # - name: ğŸ¨ Lint Check (ESLint)
        # run: pnpm lint
        # This will fail if you have any 'error' level lint rules violated

      - name: ğŸ“ Type Check (TypeScript)
        run: pnpm tsc --noEmit

      - name: ğŸ—ï¸ Production Build
        run: pnpm build
        env:
          # We provide dummy strings to satisfy the build process.
          # The build doesn't verify these, it just needs them to exist.
          NEXT_PUBLIC_API_KEY: "dummy_key"
          NEXT_PUBLIC_AUTH_DOMAIN: "dummy.firebaseapp.com"
          NEXT_PUBLIC_PROJECT_ID: "dummy-project-id"
          NEXT_PUBLIC_STORAGE_BUCKET: "dummy.appspot.com"
          NEXT_PUBLIC_MESSAGING_SENDER_ID: "123456789"
          NEXT_PUBLIC_APP_ID: "1:123456789:web:abcdef"
          NEXT_PUBLIC_MEASUREMENT_ID: "G-DUMMY"  
          # Add other required public keys here if your build fails
